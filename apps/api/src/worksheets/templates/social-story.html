<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{title}}</title>
  <style>{{styles}}</style>
</head>
<body>
  <!-- HEADER -->
  <div class="worksheet-header">
    <div class="header-left">
      <div class="worksheet-title">{{title}}</div>
      <div class="worksheet-subtitle">Social Story &bull; {{difficultyLabel}} Level</div>
    </div>
    <div class="header-meta">
      <div class="field"><span class="field-label">Date:</span> {{date}}</div>
      <div class="field"><span class="field-label">Setting:</span> {{setting}}</div>
      <div class="field"><span class="field-label">Target Skill:</span> {{targetSkill}}</div>
      <div class="meta-tags">
        {{#each domainTags}}
        <span class="meta-tag">{{this}}</span>
        {{/each}}
      </div>
    </div>
  </div>

  <!-- FILL-IN FIELDS -->
  <div class="fill-fields">
    <div class="fill-field">Child's Name: <span class="line"></span></div>
    <div class="fill-field">Read By: <span class="line"></span></div>
    <div class="fill-field">Date: <span class="line"></span></div>
  </div>

  <!-- INSTRUCTIONS -->
  <div class="instructions-box">
    <h2>How to Use This Social Story</h2>
    <p>{{instructions}}</p>
  </div>

  <!-- STORY PAGES -->
  {{#each pages}}
  <div class="story-page">
    <div class="page-number-badge">Page {{this.pageNumber}}</div>

    <div class="story-illustration-area">
      {{#if this.imageUrl}}
      <img src="{{this.imageUrl}}" alt="{{this.altText}}" class="story-illustration" />
      {{else}}
      <div class="story-illustration-placeholder">
        <div class="placeholder-label">Illustration</div>
        <div class="placeholder-desc">{{this.illustrationPrompt}}</div>
      </div>
      {{/if}}
    </div>

    <div class="story-text-area">
      <div class="sentence-type-indicator sentence-type-{{this.sentenceType}}">
        {{this.sentenceTypeLabel}}
      </div>
      <p class="story-text">{{this.text}}</p>
    </div>

    {{#if this.parentNote}}
    <div class="parent-note">
      <span class="parent-note-label">Note for Parent/Facilitator:</span>
      {{this.parentNote}}
    </div>
    {{/if}}
  </div>
  {{/each}}

  <!-- COMPREHENSION QUESTIONS -->
  {{#if comprehensionQuestions.length}}
  <div class="comprehension-section">
    <h2>Let's Think About the Story</h2>
    <p class="comprehension-intro">{{comprehensionIntro}}</p>
    <div class="questions-list">
      {{#each comprehensionQuestions}}
      <div class="question-card">
        <div class="question-number">{{questionIndex}}</div>
        <div class="question-content">
          <div class="question-text">{{this.question}}</div>
          {{#if this.hint}}
          <div class="question-hint"><span class="hint-label">Hint:</span> {{this.hint}}</div>
          {{/if}}
          <div class="question-answer-line"></div>
        </div>
      </div>
      {{/each}}
    </div>
  </div>
  {{/if}}

  <!-- TIPS -->
  {{#if tips.length}}
  <div class="tips-section">
    <h2>Tips for Reading Together</h2>
    <ul>
      {{#each tips}}
      <li>{{this}}</li>
      {{/each}}
    </ul>
  </div>
  {{/if}}

  <!-- NOTES -->
  <div class="notes-section">
    <h2>Observation Notes</h2>
    <p class="notes-prompt">{{notesPrompt}}</p>
    <div class="notes-lines">
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
    </div>
  </div>

  <!-- FOOTER -->
  <div class="worksheet-footer">
    <div class="footer-brand">
      <span class="footer-text">Generated by Upllyft &bull; upllyft.com &bull; AI-powered learning resources for the neurodivergent community</span>
    </div>
  </div>
</body>
</html>
